
# Атрибуты

## Общее описание

Атрибуты это js объект, часть контекста.

Работает как хранилище данных, обладает иерархичной структурой, хранится локально на устройстве и синхронизируется с сервером при наличии интернет-соединения.

В завистимости от роли контента, объектов атрибутов могут различаться.

Поддерживаются 2 способа изменения атрибутов - прямое изменение полей объекта и вызов метода, инициирующего изменения.

В атрибутах доступны следующие типы:

* **number** - +-Infinite и NaN не поддерживаются;
* **string**;
* **boolean**;
* **null** - отсутствие значения;
* **object** -  на стороне сервера атрибуты имеют иерархичную структуру, object рассматривается как корень для вложенных атрибутов.

Коллекции (массивы) не поддерживаются. Для реализации коллекции можно использовать объект с произвольными перечисляемыми ключами.

## Атрибуты в контексте квеста

При запуске контента для квеста объект window.story содержит, помимо прочего, следующие объекты атрибутов:

* **licenceAttributes**. Атрибуты пользователя;
* **questProgressAttributes**. Атрибуты состояния прохождения квеста.

### Варианты работы

#### Изменение полей объекта

При прямом изменении полей контекста, изменения применяются сразу, например код

`window.story.licenceAttributes.loginCount = 5`

сразу после вызова устанавливает поле контекста `loginCount` в 5. Реальные изменения и применение значения на сервере будут выполнены позже.

#### window.story.SetStory()

При вызове метода установки контекста `window.story.SetStory.
Первым параметром указывается набор ключей объектов, требующих изменения (частичный новый объект). Например, код

```js
window.story.setStory({
    licenceAttributes: {
        loginAttempts: {
            success: 3
        }
    },
    questProgressAttributes: {
        lastRetry: 'tomorrow'
    },

})
```

вызовет изменения полей

`story.licenceAttributes.loginAttempts.success = 3`

 и

`story.questProgressAttributes.lastRetry = 'tomorrow'`